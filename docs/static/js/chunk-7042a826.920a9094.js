/*!
 *  build: shark-admin 
 *  https://elwin0204.github.io/shark-admin 
 *  https://github.com/elwin0204/shark-admin 
 *  time: 2024-3-3 23:30:14
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7042a826"],{"083a":function(e,t,o){"use strict";var s=o("0d51"),r=TypeError;e.exports=function(e,t){if(!delete e[t])throw r("Cannot delete property "+s(t)+" of "+s(e))}},"1ed6":function(e,t,o){},"1ee7":function(e,t,o){},"3c65":function(e,t,o){"use strict";var s=o("23e7"),r=o("7b0b"),i=o("07fa"),l=o("3a34"),a=o("083a"),n=o("3511"),c=1!==[].unshift(0),d=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}},u=c||!d();s({target:"Array",proto:!0,arity:1,forced:u},{unshift:function(e){var t=r(this),o=i(t),s=arguments.length;if(s){n(o+s);var c=o;while(c--){var d=c+s;c in t?t[d]=t[c]:a(t,d)}for(var u=0;u<s;u++)t[u]=arguments[u]}return l(t,o+s)}})},"5c97":function(e,t,o){"use strict";o("1ed6")},"62b4":function(e,t,o){"use strict";o("1ee7")},"7a1f":function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-dialog",{attrs:{title:e.title,visible:e.dialogFormVisible,width:"500px"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.close}},[o("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"auto"}},[o("el-form-item",{attrs:{label:"角色名称",prop:"role"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}})],1),o("el-form-item",{attrs:{label:"角色编码",prop:"roleCode"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.roleCode,callback:function(t){e.$set(e.form,"roleCode",t)},expression:"form.roleCode"}})],1),o("el-form-item",{attrs:{label:"备注",prop:"remark"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.close}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)},r=[],i=o("e157"),l={name:"RoleManagementEdit",data(){return{form:{role:"",roleCode:"",remark:"",datetime:""},rules:{permission:[{required:!0,trigger:"blur",message:"请输入权限码"}]},title:"",dialogFormVisible:!1}},created(){},methods:{showEdit(e){e?(this.title="编辑",this.form=Object.assign({},e)):this.title="新增",this.dialogFormVisible=!0},close(){this.$refs["form"].resetFields(),this.form=this.$options.data().form,this.dialogFormVisible=!1},save(){this.$refs["form"].validate(async e=>{if(!e)return!1;{const{msg:e}=await Object(i["doEdit"])(this.form);this.$baseMessage(e,"success"),this.$emit("fetch-data"),this.close()}})}}},a=l,n=o("2877"),c=Object(n["a"])(a,s,r,!1,null,null,null);t["default"]=c.exports},"8df9":function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-dialog",{attrs:{title:e.title,visible:e.dialogFormVisible,width:"800px"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.close}},[o("el-tree",{ref:"REF_MenuTree",attrs:{data:e.menuTree,props:e.props,"node-key":"id",load:e.loadNode,"show-checkbox":"","check-strictly":e.checkStrictly},on:{"check-change":e.handleCheckChange},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node,r=t.data;return o("span",{staticClass:"custom-tree-node"},[o("span",[e._v(e._s(s.label))]),o("span",{staticStyle:{"margin-left":"50px"}},e._l(r.btnPermissions,(function(t,s){return o("el-checkbox",{key:s,model:{value:t.checked,callback:function(o){e.$set(t,"checked",o)},expression:"item.checked"}},[e._v(" "+e._s(t.title)+" ")])})),1)])}}])}),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.close}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)},r=[],i=(o("3c65"),o("14d9"),o("e157"),o("2033")),l=o("056f"),a={name:"RolePermission",data(){return{props:{label:"title",children:"children"},checkStrictly:!1,menuTree:[],title:"分配权限",dialogFormVisible:!1}},created(){},methods:{async showPermission(e){const{data:t}=await Object(i["getRouteList"])();this.menuTree=Object(l["arr2Tree"])(t,!0),this.dialogFormVisible=!0},handleCheckChange(e,t,o){const{btnPermissions:s}=e;for(const r of s)this.$set(r,"checked",t)},loadNode(e,t){},close(){this.dialogFormVisible=!1},getAllCheckedKeys(){const e=this.$refs["REF_MenuTree"].getCheckedKeys(),t=this.$refs["REF_MenuTree"].getHalfCheckedKeys();return e.unshift.apply(e,t),e},getBtnCheckedKeys(e,t=[]){return e.forEach(e=>{e.children&&e.children.length>0?this.getBtnCheckedKeys(e.children,t):e.btnPermissions&&e.btnPermissions.forEach(e=>{e.checked&&t.push(e.id)})}),t},async save(){const e=this.getAllCheckedKeys(),t=this.getBtnCheckedKeys(this.menuTree);console.log("menuList",e),console.log("btnList",t)}}},n=a,c=(o("5c97"),o("2877")),d=Object(c["a"])(n,s,r,!1,null,"6b3fb704",null);t["default"]=d.exports},e157:function(e,t,o){"use strict";o.r(t),o.d(t,"getList",(function(){return r})),o.d(t,"doEdit",(function(){return i})),o.d(t,"doDelete",(function(){return l}));var s=o("b775");function r(e){return Object(s["default"])({url:"/roleManagement/getList",method:"post",data:e})}function i(e){return Object(s["default"])({url:"/roleManagement/doEdit",method:"post",data:e})}function l(e){return Object(s["default"])({url:"/roleManagement/doDelete",method:"post",data:e})}},f398:function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"role-container"},[o("el-card",[o("el-row",{attrs:{type:"flex",align:"middle",gutter:20}},[o("el-col",{attrs:{xs:24,sm:24,md:12,lg:12,xl:12}},[o("el-form",{attrs:{inline:!0,model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[o("el-form-item",[o("el-input",{attrs:{placeholder:"请输入角色",clearable:""},model:{value:e.queryForm.role,callback:function(t){e.$set(e.queryForm,"role","string"===typeof t?t.trim():t)},expression:"queryForm.role"}})],1),o("el-form-item",[o("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.queryData}},[e._v(" 查询 ")])],1)],1)],1),o("el-col",{attrs:{xs:24,sm:24,md:12,lg:12,xl:12}},[o("div",{staticClass:"btns-box"},[o("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:e.handleEdit}},[e._v(" 新增 ")]),o("el-button",{attrs:{icon:"el-icon-delete",type:"danger"},on:{click:e.handleDelete}},[e._v(" 批量删除 ")])],1)])],1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":e.elementLoadingText},on:{"selection-change":e.setSelectRows}},[o("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"role",label:"角色名称"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"roleCode",label:"角色编码"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"remark",label:"备注"}}),o("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"datetime",label:"创建时间"}}),o("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[o("el-button",{attrs:{plain:"",type:"primary",size:"mini"},on:{click:function(t){return e.handleEdit(s)}}},[e._v(" 编辑 ")]),o("el-button",{attrs:{plain:"",type:"success",size:"mini"},on:{click:function(t){return e.assignPermission(s)}}},[e._v(" 分配权限 ")]),o("el-button",{attrs:{plain:"",type:"danger",size:"mini"},on:{click:function(t){return e.handleDelete(s)}}},[e._v(" 删除 ")])]}}])})],1),o("el-pagination",{attrs:{background:"","current-page":e.queryForm.pageNo,"page-size":e.queryForm.pageSize,layout:e.layout,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),o("role-edit",{ref:"REF_Edit",on:{"fetch-data":e.fetchData}}),o("role-permission",{ref:"REF_AssignPermission",on:{"fetch-data":e.fetchData}})],1)},r=[],i=o("e157"),l=o("7a1f"),a=o("8df9"),n={name:"RoleManagement",components:{RoleEdit:l["default"],RolePermission:a["default"]},data(){return{list:null,listLoading:!0,layout:"total, sizes, prev, pager, next, jumper",total:0,selectRows:"",elementLoadingText:"正在加载...",queryForm:{pageNo:1,pageSize:10,role:""}}},created(){this.fetchData()},methods:{setSelectRows(e){this.selectRows=e},handleEdit(e){e.role?this.$refs["REF_Edit"].showEdit(e):this.$refs["REF_Edit"].showEdit()},assignPermission(e){console.log("assignPermission",e),this.$refs["REF_AssignPermission"].showPermission(e)},handleDelete(e){if(e.id)this.$baseConfirm("你确定要删除当前项吗",null,async()=>{const{msg:t}=await Object(i["doDelete"])({ids:e.id});this.$baseMessage(t,"success"),this.fetchData()});else{if(!(this.selectRows.length>0))return this.$baseMessage("未选中任何行","error"),!1;{const e=this.selectRows.map(e=>e.id).join();this.$baseConfirm("你确定要删除选中项吗",null,async()=>{const{msg:t}=await Object(i["doDelete"])({ids:e});this.$baseMessage(t,"success"),this.fetchData()})}}},handleSizeChange(e){this.queryForm.pageSize=e,this.fetchData()},handleCurrentChange(e){this.queryForm.pageNo=e,this.fetchData()},queryData(){this.queryForm.pageNo=1,this.fetchData()},async fetchData(){this.listLoading=!0;const{data:e,totalCount:t}=await Object(i["getList"])(this.queryForm);this.list=e,this.total=t,setTimeout(()=>{this.listLoading=!1},300)}}},c=n,d=(o("62b4"),o("2877")),u=Object(d["a"])(c,s,r,!1,null,"7a758874",null);t["default"]=u.exports}}]);